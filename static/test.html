<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>iVideo</title>
    <style>body, time, p, h1, h2, h3, h4, h5, h6,
        ul, ol {
          margin: 0;
          padding: 0;
        }
        
        .play-list {
          margin-top: 20px;
          border-top: 1px solid #ddd;
          list-style: none;
        }
        .play-list li {
          position: relative;
          height: 40px;
          line-height: 40px;
          font-size: 14px;
          padding: 0 15px;
        }
        .play-list li:after {
          content: '';
          position: absolute;
          height: 1px;
          left: 15px;
          right: 15px;
          bottom: 0;
          background: #ddd;
        }
        .play-list .active {
          color: #00f;
          background: rgba(0, 0, 0, 0.1);
        }
        
    </style>
    <link rel="stylesheet" href="css/video.css">
</head>
<body>
    <div id="app">
        <div class="ivideo-container"></div>
        <div class="play-list"></div>
    </div>

    <script src="./js/ivideo.min.js"></script>
    <script>
        var player = null;
        var curIndex = 0;
        var root = 'http://hc.yinyuetai.com/uploads/videos/common/';
        // http://hc.yinyuetai.com/uploads/videos/common/C55C01649BE431367709E70897C5D6F2.mp4
        // http://hc.yinyuetai.com/uploads/videos/common/F8C1015D1AF22E61A0533391A27435A3.mp4
        var data = [
            {video: '0359016627C34455581212A5C823797F', title: '飘向北方-王力宏'},
            {video: 'C55C01649BE431367709E70897C5D6F2', title: '等你下课-李建'},
            {video: 'F8C1015D1AF22E61A0533391A27435A3', title: '骄傲的少年'}
        ]

        function init () {
            render();
            evts();

            // 初始化播放器
            player = new iVideo('.ivideo-container', {
                src: {
                    src: root + data[0].video + '.mp4',
                    title: data[0].title
                }
            });
        }

        function evts () {
            var list = document.querySelector('.play-list');

            list.addEventListener('click', function(e){
                if (e.target.tagName === 'LI') {
                    curIndex = e.target.getAttribute('data-index') - 0;
                    var url = root + e.target.getAttribute('data-src');
                    player.src({
                        url,
                        title: e.target.getAttribute('title')
                    });
                    render();
                }
            });
        }


        function render () {
            var list = document.querySelector('.play-list');
            var html = '';
            data.forEach(function(item, index){
                html += '<li data-src="' + item.video + '.mp4" title="' + item.title + '" data-index="' + index + '"';
                html += index === curIndex ? ' class="active"': '';
                html += '>' + item.title + '</li>';
            });
            list.innerHTML = html;
        }


        window.onload = init;
    </script>
</body>
</html>